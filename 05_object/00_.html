<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name ="format-detection" content ="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>05_객체생성패턴</title>
<style type="text/css">
body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,textarea,p,blockquote,th,td,input,select,textarea,button {margin:0;padding:0}
a {color:#1b52b1;text-decoration:underline}
a:active, a:hover {text-decoration:underline}
li ul{padding-left:10px;}
h1 {font-size:25px;padding-top:10px;}
h2 {color:#000b72;font-size:22px;padding-bottom:10px;padding-top:10px;border-bottom:1px solid #d0d0d0;}
h3 {font-size:14px;padding:10px 20px;background:#d0d0d0;}
header h2 {margin-top:20px;font-size:14px;padding:10px 20px;background:#d0d0d0;color:#333;}
h4 {color:#000;padding:10px 20px;border:1px solid #d0d0d0;}

section {padding:10px;}
article {padding:20px;}
xmp {margin:2%;background:#f1f1f1;white-space:pre-line;padding:0 2% 1% 2%;}
pre{font-size:16px;font-family:tahoma;}
pre span{color:#fff;font-size:14px;}
header > div, section > div {margin-bottom:20px;border:1px solid #d0d0d0;padding:5px 30px;}
.colorscripter-code{border:0;padding:0;}
.colorscripter-code table{width:100%;}
.data_box table td{text-align:center;}
ul {padding:10px 0;}
ol {padding-left:20px;}
p {padding-top:10px;}
.btn_top{display:inline-block;position:fixed;bottom:10px;right:10px;width:50px;height:50px;line-height:50px;background:#d0d0d0;color:#000;text-align:center;}
footer{text-align:right;}
section em{display:block;color:#595;}
</style>
</head>
<body>
<div class="wrap guide_wrap">
	<header>
		<h1>05_객체생성패턴</h1>

		<h2>목차</h2>
		<div>
			<ol>
				<li><a href="#con1">5.1 네임스페이스 패턴</a></li>
				<li><a href="#con2">5.2 의존 관계 선언</a></li>
				<li><a href="#con3">5.3 비공개 프로퍼티와 메서드</a></li>
				<li><a href="#con4">5.4 모듈 패턴</a></li>
				<li><a href="#con5">5.5 샌드박스 패턴</a></li>
				<li><a href="#con6">5.6 스태틱 멤버</a></li>
				<li><a href="#con7">5.7 객체 상수</a></li>
				<li><a href="#con8">5.8 체이닝 패턴</a></li>
				<li><a href="#con9">5.9 method() 메서드</a></li>
				<li><a href="#con10">5.10 요약</a></li>
			</ol>
		</div>
	</header>
	<section>
		<div>
			자바스크립트에서는 객체 리터럴이나 생성자 함수를 사용하여 아주 쉽게 객체를 만들 수 있다. <strong>이 장에서는 좀더 나아가 객체를 생성하는 또 다른 패턴들을 살펴볼 것이다.</strong><br><br>
			이 장에서는 다른언어에서 사용되는 기능(네임스페이스나 모듈패키지, 비공개 프로퍼티, 스태틱멤버등 )들을 구현하거나 대체하거나 또는 다른관점에서 바라볼 수 있게 해주는 범용적인 패턴들에 대해 알아본다. <br><br>
			네임스페이스 패턴, 의존 관계 선언, 모듈 패턴, 샌드박스 패턴 등은 애플리케이션 코드를 정리하고 구조화할 수 있게 도와주고 암묵적 전역의 영향력을 약화시킨다. <br>
			또한 비공개 멤버와 특권 멤버, 공개/비공개 스태틱 멤버, 객체상수, 체이닝에 대해서도 다루고, 클래스와 비슷한 방식으로 생성자를 정의하는 방법도 하나 살펴본다.
		</div>

		<h2 id="con1">5.1 네임스페이스 패턴</h2>
		<section>
			<div>
				네임스페이스는 꽤 쉽게 구현할 수 있는 기능이다.<br>
				수많은 함수, 객체, 변수들로 전역 유효범위를 어지럽히는 대신, 애플리케이션이나 라이브러리를 위한 전역객체를 하나 만들고(단 하나만 만드는것이 이상적).<br>
				모든 기능을 이 객체에 추가하면 된다.
			</div>

			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%"><span style="color: #75715e">// 수정 전: 전역변수 5개</span>

				<span style="color: #75715e">// 생성자 함수 2개</span>
				<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">Parent</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{}</span>
				<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">Child</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{}</span>

				<span style="color: #75715e">// 변수 1개</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">some_var</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>

				<span style="color: #75715e">// 객체 2개</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">module1</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>
				<span style="color: #a6e22e">module1</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">data</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span><span style="color: #a6e22e">a</span><span style="color: #f92672">:</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">b</span><span style="color: #f92672">:</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">};</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">module2</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>
				</pre>
			</div>

			<div>
				위와 같은 코드를 리팩터링 하기 위해서는 먼저 애플리케이션 전용 객체, 이를테면 MYAPP을 생성한다. 그런 다음 모든 함수와 변수들을 이 전역 객체의 프로퍼티로 변경한다.
			</div>

			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%"><span style="color: #75715e">// 수정 후 : 전역변수 1개</span>

				<span style="color: #75715e">// 전역객체</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>

				<span style="color: #75715e">// 생성자</span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">Parent</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{};</span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">Child</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{};</span>

				<span style="color: #75715e">// 변수</span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">some_var</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>

				<span style="color: #75715e">// 객체 컨테이너 </span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">modules</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>

				<span style="color: #75715e">// 객체들을 컨테이너 안에 추가한다. </span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">modules</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">module1</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">modules</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">module1</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">data</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span><span style="color: #a6e22e">a</span><span style="color: #f92672">:</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">b</span><span style="color: #f92672">:</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">};</span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">modules</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">module2</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>
				</pre>
			</div>

			<div>
				이 패턴은 코드에 네임스페이스를 지정해주며, 코드 내의 이름 충돌 뿐 아니라 이 코드와 같은 페이지에 존재하는 자바스크립트 라이브러리나 위짓 등 서드파티 코드와의 이름충돌도 방지해준다. 다양한 작업에 으용할 수 있으며 매우 권장하는 패턴이다. <br><br>
				But, 단점 !!<br><br>
				<ul>
					<li>
						모든 변수와 함수에 접두어를 붙여야 하기 때문에 전체적으로 코드량이 약간 더 많아지고 따라서 다운로드해야 하는 파일 크기도 늘어난다.
					</li>
					<li>
						전역 인스턴스가 단 하나뿐이기 때문에 코드의 어느 한 부분이 수정되어도 전역 인스턴스를 수정하게 된다. 즉 나머지 기능들도 갱신된 상태를 물려받는다.
					</li>
					<li>
						 이름이 중첩되고 길어지므로 프로퍼티를 판별하기 위한 검색작업도 길고 느려진다. 이 장의 뒷부분에서는 이 단점을 해결하는 샌드박스 패턴을 다룰 것이다.
					</li>
				</ul>
			</div>

			<h3>범용 네임스페이스 함수</h3>
			<div>
				네임스페이스에 추가하려는 프로퍼티가 이미 존재할 수도 있고, 내용을 덮어쓰게 될지도 모른다. -> <strong>네임스페이스를 생성하거나 프로퍼티를 추가하기 전에 먼저 이미 존재하는 지 여부를 확인하는것이 최선</strong>
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%"><span style="color: #75715e">// 위험하다</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>

				<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">typeof</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">===</span> <span style="color: #e6db74">&quot;undefined&quot;</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>
				<span style="color: #f8f8f2">}</span>

				<span style="color: #75715e">// 또는 더 짧게 쓸 수 있다.</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">||</span> <span style="color: #f8f8f2">{};</span>
				</pre>
			</div>

			<div>
				위와 같이 추가되는 확인 작업 때문에 상당량의 중복 코드가 생겨날수 있으므로 네임스페이스 생성의 실제작업을 맡아줄 재사용 가능한 함수를 만들어두면 편리하다.
			</div>

			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%"><span style="color: #75715e">// 네임스페이스 함수를 사용한다.</span>
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;MYAPP.modules.module2&#39;</span><span style="color: #f8f8f2">);</span>

				<span style="color: #75715e">// 위 코드는 다음과 같은 결과를 반환한다.</span>
				<span style="color: #75715e">// var MYAPP = {</span>
				<span style="color: #75715e">//     modules : {</span>
				<span style="color: #75715e">//        module2 : {}</span>
				<span style="color: #75715e">//     }</span>
				<span style="color: #75715e">//};</span>
				</pre>
			</div>

			<div>아래는 네임스페이스 함수를 구현한 예제</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
			<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span> <span style="color: #f92672">||</span> <span style="color: #f8f8f2">{};</span>

			     <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">ns_string</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">parts</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">ns_string</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">split</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;.&#39;</span><span style="color: #f8f8f2">),</span>
					<span style="color: #a6e22e">parent</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">,</span>
					<span style="color: #a6e22e">i</span><span style="color: #f8f8f2">;</span>
				<span style="color: #75715e">// 처음에 중복되는 전역 객체명은 제거한다.</span>
				<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">parts</span><span style="color: #f8f8f2">[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">===</span> <span style="color: #e6db74">&quot;MYAPP&quot;</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #a6e22e">parts</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">parts</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">slice</span><span style="color: #f8f8f2">(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">);</span>
				<span style="color: #f8f8f2">}</span>

				<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">parts</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 프로퍼티가 조냊하지 않으면 생성한다.</span>
					<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">typeof</span> <span style="color: #a6e22e">parent</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">parts</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]]</span> <span style="color: #f92672">===</span> <span style="color: #e6db74">&quot;undefined&quot;</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">parent</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">parts</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{};</span>
					<span style="color: #f8f8f2">}</span>

					<span style="color: #a6e22e">parent</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">parent</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">parts</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]];</span>
				<span style="color: #f8f8f2">}</span>
				<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">parent</span><span style="color: #f8f8f2">;</span>
			<span style="color: #f8f8f2">};</span>

			<span style="color: #75715e">// 반환값을 지역 변수에 할당한다.</span>
			<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">module2</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;MYAPP.modules.module2&#39;</span><span style="color: #f8f8f2">);</span>
			<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">module2</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">modules</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">module2</span><span style="color: #f8f8f2">);</span>

			<span style="color: #75715e">// 첫부분의 &#39;MYAPP&#39;을 생략하고도 쓸 수 있다.</span>
			<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;modules.module51&#39;</span><span style="color: #f8f8f2">);</span>
			</pre>
			</div>
		</section>

		<h2 id="con2">5.2 의존 관계 선언</h2>
		<section>
			<div>
				자바스크립트 라이브러리들은 대게 네임스페이스를 지정하여 모듈화되어 있기 때문에, 필요한 모듈만 골라서 쓸 수 있다. <br>
				이 때 함수나 모듈 내 최상단에, 의존 관계에 있는 모듈으르 선언하는 것이 좋다. 즉 지역 변수를 만들어 원하는 모듈을 가리키도록 선언하는 것이다.
			</div>

			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">myFunction</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 의존 관계에 있는 모듈들</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">event</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">YAHOO</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">util</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">Event</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">dom</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">YAHOO</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">util</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">Dom</span><span style="color: #f8f8f2">;</span>

					<span style="color: #75715e">// 이제 event 와 dom이라는 변수를 사용한다. </span>
				<span style="color: #f8f8f2">}</span>
				</pre>
			</div>

			<div>
				대딘히 간단한 패턴이지만 상당히 많은 장점을 가지고 있다. <br><br>
				<ul>
					<li>
						 의존 관계가 명시적으로 선언되어 있기 때문에 코드를 사용하는 사람이 페이지내에 반드시 포함시켜야 하는 스크립트 파일이 무엇인지 알 수 있다.
					</li>
					<li>
						함수의 첫머리에 의존 관계가 선언되기 때문에 의존 관계를 찾아내고 이해하기가 쉽다.
					</li>
					<li>
						dom 과 같은 지연변수는 YAHOO 와 같은 전역변수보다 언제나 더 빠르며 YAHOO.util.Dom처럼 전역 변수 중첩 프로퍼티와 비교하면 더 말할 것도 없다. 의존 관계 선언 패턴을 잘 지키면 함수 안에서 전역 객체 판별을 닫 한번만 수행하고, 이 다음부터는 지역변수를 사용하기 때문에 훨씬 빠르다.
					</li>
					<li>
						YUI 컴프레서나 구글 클로저 등 고급 압축 도구는 지역 변수명에 대해서는 event를 A 라는 글자 하나로 바꾸는 식으로 축약해 코드를 줄여준다. 하지만 전역 변수명 변경은 위험하기 때문에 축약하지 않는다.
					</li>
				</ul>
			</div>
		</section>

		<h2 id="con3">5.3 비공개 프로퍼티와 메서드</h2>
		<section>
			<div>
				비공개 멤버에 대한 별도의 문법은 없지만 클로저를 사용해서 구현할 수 있다. <br>
				생성자 함수안에서 클로저를 만들면, 클로저 유효범위 안의 변수는 생성자 함수 외부에 노출되지 않지만 객체의 공개 메서드안에서는 쓸 수 있다. 즉 생성자에서 객체를 반환할 때 객체의 메서드를 정의하면, 이 메서드 안에서는 비공개 변수에 접근할 수 있는 것이다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 비공개 멤버</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">name</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&#39;iPod&#39;</span><span style="color: #f8f8f2">;</span>
					<span style="color: #75715e">// 공개된 함수</span>
					<span style="color: #66d9ef">this</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getName</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">name</span><span style="color: #f8f8f2">;</span>
					<span style="color: #f8f8f2">}</span>
				<span style="color: #f8f8f2">}</span>

				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">toy</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">();</span>

				<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">toy</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">name</span><span style="color: #f8f8f2">);</span>
				<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">toy</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getName</span><span style="color: #f8f8f2">());</span>
				</pre>
			</div>

			<h3>특권(privileged) 메서드</h3>
			<div>
				특권 메서드라는 개념은 특정한 문법과는 관련이 없다. 단지 비공개 멤버에 접근권한을 가진(즉 일종의 특권을 부여받은) 공개 메서드를 가리키는 이름일 뿐이다.<br>
				앞선 예제에서 getName()은 비공개 프로퍼티인 name에 '특별한' 접근권한을 가지고 있기 때문에 특권 메서드라고 할 수 있다.
			</div>

			<h3>비공개 멤버의 허점</h3>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 비공개 멤버</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">specs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">screen_width</span> <span style="color: #f92672">:</span> <span style="color: #ae81ff">320</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">screen_height</span><span style="color: #f92672">:</span> <span style="color: #ae81ff">480</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">color</span> <span style="color: #f92672">:</span> <span style="color: #e6db74">&quot;white&quot;</span>
					<span style="color: #f8f8f2">};</span>

					<span style="color: #66d9ef">this</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getSpecs</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">specs</span><span style="color: #f8f8f2">;</span>
					<span style="color: #f8f8f2">};</span>
				<span style="color: #f8f8f2">}</span>

				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">toy</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">(),</span>
					<span style="color: #a6e22e">specs</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">toy</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getSpecs</span><span style="color: #f8f8f2">();</span>

				<span style="color: #a6e22e">specs</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">color</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;black&quot;</span><span style="color: #f8f8f2">;</span>
				<span style="color: #a6e22e">specs</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">price</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;free&quot;</span><span style="color: #f8f8f2">;</span>

				<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">dir</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">toy</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getSpecs</span><span style="color: #f8f8f2">());</span>
				</pre>
			</div>
			<div>
				위에 나오는 Gadget 구현은 얼핏 보기엔 별 문제가 없어 보인다. <br>
				여기서 getSpec() 메서드가 specs 객체에 대한 참조를 반환한다는 게 문제다. <br>
				specs는 감춰진 비공개 멤버처럼 보이지만 Gadget 사용자에 의해 변경될 소지가 있다.  <br> <br>

				<strong>해결법</strong><br> <br>
				getSpecs()에서 아예 새로운 객체를 만들어 사용자에게 쓸모있을 만한 데이터 일부만 담아 반환하는 것이다. 이것을 <strong>'최소한의 원칙(Principle of Least Authority, POLA)'</strong>이라고도 한다. <br><br>
				모든 데이터를 넘겨야 한다면, 객체를 복사하는 범용함수를 사용하여 specs객체의 복사본을 만드는 것도 방법이 될 수 있다.
			</div>

			<h3>객체 리터럴과 비공개 멤버</h3>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">myobj</span><span style="color: #f8f8f2">;</span>

				<span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 비공개 멤버</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">name</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;my, oh my&quot;</span><span style="color: #f8f8f2">;</span>

					<span style="color: #75715e">// 공개된 부분을 구현한다.</span>
					<span style="color: #75715e">// var를 사용하지 않았다는 데 유의</span>
					<span style="color: #a6e22e">myobj</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #75715e">// 특권 메서드 </span>
						<span style="color: #a6e22e">getName</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">name</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">}</span>
					<span style="color: #f8f8f2">}</span>
				<span style="color: #f8f8f2">}());</span>

				<span style="color: #a6e22e">myobj</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getName</span><span style="color: #f8f8f2">();</span>
				</pre>
			</div>

			<div>
				다음 예제는 기본개념을 동일하지만 약간 다르게 구현해본 것이다. <br>
				이 예제는 곧 살펴보게 될 '모듈 패턴'의 기초가 되는 부분이기도 하다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">myobj</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 비공개 멤버</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">name</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;my, oh my&quot;</span><span style="color: #f8f8f2">;</span>

					<span style="color: #75715e">// 공개될 부분을 구현한다.</span>
					<span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">getName</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">name</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">}</span>
					<span style="color: #f8f8f2">};</span>
				<span style="color: #f8f8f2">}());</span>

				<span style="color: #a6e22e">myobj</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getName</span><span style="color: #f8f8f2">();</span>
				</pre>
			</div>

			<h3>프로토타입과 비공개 멤버</h3>
			<div>
				생성자를 사용하여 비공개 멤버를 만들 경우, 생성자를 호출하여 새로운 객체를 만들 때마다 비공개 멤버가 매번 재생성 된다는 단점이 있다. <br>
				사실 생성자 내부에서 this에 멤버를 추가하면 항상 이런 문제가 발생한다. 이러한 중복을 없애고 메모리를 절약하려면 공통 프로퍼티와 메서드를 생성자의 prototype 프로퍼티에 추가해야 한다. 이렇게 하면 동일한 생성자로 생성한 모든 인스턴스가 공통된 부분들 공유하게 된다. 감춰진 비공개 멤버들도 모든 인스턴스가 함께 쓸 수 있다. <br>이를 위해서는 두가지 패턴, 즉 생성자 함수 내부에 비공개 멤버를 만드는 패턴과 객체 리터럴로 비공개 멤버를 만드는 패턴을 함께 써야 한다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 비공개 멤버</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">name</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&#39;iPod&#39;</span><span style="color: #f8f8f2">;</span>
					<span style="color: #75715e">// 공개함수</span>
					<span style="color: #66d9ef">this</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getName</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">name</span><span style="color: #f8f8f2">;</span>
					<span style="color: #f8f8f2">};</span>
				<span style="color: #f8f8f2">}</span>

				<span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">prototype</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 비공개 멤버 </span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">browser</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;Mobile Webkit&quot;</span><span style="color: #f8f8f2">;</span>

					<span style="color: #75715e">//공개된 프로토타입 멤버</span>
					<span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">getBrowser</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">browser</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">}</span>
					<span style="color: #f8f8f2">}</span>
				<span style="color: #f8f8f2">}());</span>

				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">toy</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">Gadget</span><span style="color: #f8f8f2">();</span>
				<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">toy</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getName</span><span style="color: #f8f8f2">());</span> <span style="color: #75715e">// 객체 인스턴스의 특권 메서드</span>
				<span style="color: #a6e22e">console</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">log</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">toy</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">getBrowser</span><span style="color: #f8f8f2">())</span>  <span style="color: #75715e">// 프로토타입의 특권 메서드 </span>
				</pre>
			</div>

			<h3>비공개 함수를 공개 메서드로 노출시키는 방법</h3>
			<div>
				노출 패턴(revelation pattern)은 비공개 메서드를 구현하면서 동시에 공개 메서드로도 노출하는 것 <br><br>
				객체의 기능을 최대한의 보호가 필요한 동시에 유용성 때문에 공개적인 접근도 허용하고 싱픈 경우가 있을 수 있다. <br>
				노출 패턴은 이러한 경우에 유용하게 쓸 수 있다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">myarray</span><span style="color: #f8f8f2">;</span>

				<span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">astr</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;[object Array]&quot;</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">toString</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Object.</span><span style="color: #a6e22e">prototype</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">toString</span><span style="color: #f8f8f2">;</span>

					<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">isArray</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">toString</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">call</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">astr</span><span style="color: #f8f8f2">;</span>
					<span style="color: #f8f8f2">}</span>

					<span style="color: #66d9ef">function</span> <span style="color: #a6e22e">indexOf</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">needle</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span>
							<span style="color: #a6e22e">max</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span>
							<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">max</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
								<span style="color: #a6e22e">console</span>
								<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">needle</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
									<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">i</span><span style="color: #f8f8f2">;</span>
								<span style="color: #f8f8f2">}</span>
							<span style="color: #f8f8f2">}</span>
							<span style="color: #66d9ef">return</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>
					<span style="color: #f8f8f2">}</span>

					<span style="color: #a6e22e">myarray</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">isArray</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">isArray</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">indexOf</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">indexOf</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">inArray</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">indexOf</span>
					<span style="color: #f8f8f2">}</span>

				<span style="color: #f8f8f2">}());</span>

				<span style="color: #a6e22e">myarray</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">isArray</span><span style="color: #f8f8f2">([</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">]);</span>
				<span style="color: #a6e22e">myarray</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">isArray</span><span style="color: #f8f8f2">({</span><span style="color: #ae81ff">0</span> <span style="color: #f92672">:</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">});</span>
				<span style="color: #a6e22e">myarray</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">indexOf</span><span style="color: #f8f8f2">([</span><span style="color: #e6db74">&#39;a&#39;</span><span style="color: #f8f8f2">,</span><span style="color: #e6db74">&#39;b&#39;</span><span style="color: #f8f8f2">,</span><span style="color: #e6db74">&#39;z&#39;</span><span style="color: #f8f8f2">],</span> <span style="color: #e6db74">&#39;z&#39;</span><span style="color: #f8f8f2">);</span>
				<span style="color: #a6e22e">myarray</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">inArray</span><span style="color: #f8f8f2">([</span><span style="color: #e6db74">&#39;a&#39;</span><span style="color: #f8f8f2">,</span><span style="color: #e6db74">&#39;b&#39;</span><span style="color: #f8f8f2">,</span><span style="color: #e6db74">&#39;z&#39;</span><span style="color: #f8f8f2">],</span> <span style="color: #e6db74">&#39;z&#39;</span><span style="color: #f8f8f2">);</span>
				</pre>
			</div>

			<div>
				이제 공개된 메서드인 indexOf() 에 예기치 못한 일이 일어나더라도, 비공개 함수인 indexOf는 안전하게 보호되기 때문에 inArray()는 계속해서 잘 동작할 것이다.
			</div>


		</section>

		<h2 id="con4">5.4 모듈 패턴</h2>
		<section>
			<div>
				모듈 패턴은 지금까지 살펴본 다음 패턴들 여러 개를 조합한 것이다. <br><br>
				<ul>
					<li>네임스페이스 패턴</li>
					<li>즉시 실행함수</li>
					<li>비공개 멤버와 특권멤버</li>
					<li>의존 관계 선언</li>
				</ul>
			</div>

			<div>
				첫 단계는 네임스페이스를 설정하는 것 - ><br>
				 모듈을 정의 (공개여부를 제한해야한다면 즉시 실행함수를 사용하여 비공개 유효범위를 만들면 된다.) 즉시 실행 함수는 모듈이 될 객체를 반환한다. 이 객체에는 모듈 사용자에게 제공할 공개 인터페이스가 담기게 될것이다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;MYAPP.utilities.array&#39;</span><span style="color: #f8f8f2">);</span>

				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">array</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #75715e">// 여기에 객채내용 구현 </span>
						<span style="color: #75715e">// 이제 공개 인터페이스에 메서드를 추가해보자. </span>
						<span style="color: #a6e22e">inArray</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">neddle</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #75715e">// ...</span>
						<span style="color: #f8f8f2">},</span>
						<span style="color: #a6e22e">isArray</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #75715e">// ...</span>
						<span style="color: #f8f8f2">}</span>
					<span style="color: #f8f8f2">}</span>
				<span style="color: #f8f8f2">}());</span>
				</pre>
			</div>

			<div>
				즉시 실행 함수의 비공개 유효범위를 사용하면, 비공개 프로퍼티와 메소드를 마음껏 선언할 수 있다. <strong>모듈에 의존관계가 있다면 즉시 실행함수 상단에서 정의한다.</strong> 변수를 선언한 다음에는 필요에 따라 모듈을 초기화하는데 필요한 일회성 초기화 코드를 두어도 좋다. 즉시 실행 함수가 반환하는 최종 결과는 모듈의 공개 API를 담은 객체다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;MYAPP.utilities.array&#39;</span><span style="color: #f8f8f2">);</span>

				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">array</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
					<span style="color: #75715e">// 의존관계</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">uobj</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">object</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">ulang</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Object.</span><span style="color: #a6e22e">prototype</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">toString</span><span style="color: #f8f8f2">,</span>

						<span style="color: #75715e">//비공개 프로퍼티</span>
						<span style="color: #a6e22e">array_string</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;[object Array]&quot;</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">ops</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Object.</span><span style="color: #a6e22e">prototype</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">toString</span><span style="color: #f8f8f2">;</span>

					<span style="color: #75715e">// 비공개 메서드들</span>
					<span style="color: #75715e">// ....</span>

					<span style="color: #75715e">// var 선언을 마친다. </span>
					<span style="color: #75715e">// 필요하면 일회성 초기화 절차를 실행한다. </span>

					<span style="color: #75715e">// 공개 API</span>
					<span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #75715e">// 여기에 객채내용 구현 </span>
						<span style="color: #75715e">// 이제 공개 인터페이스에 메서드를 추가해보자. </span>
						<span style="color: #a6e22e">inArray</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">neddle</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span> <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">max</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">max</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">){</span>
								<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">needle</span><span style="color: #f8f8f2">){</span>
									<span style="color: #66d9ef">return</span> <span style="color: #66d9ef">true</span><span style="color: #f8f8f2">;</span>
								<span style="color: #f8f8f2">}</span>
							<span style="color: #f8f8f2">}</span>
						<span style="color: #f8f8f2">},</span>
						<span style="color: #a6e22e">isArray</span> <span style="color: #f92672">:</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">ops</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">call</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">array_string</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">}</span>
						<span style="color: #75715e">// ... 더 필요한 메서드와 프로퍼티를 여기 추가 </span>
					<span style="color: #f8f8f2">}</span>
				<span style="color: #f8f8f2">}());</span>
				</pre>
			</div>

			<h3>모듈 노출 패턴</h3>
			<div>
				 모든 메서드를 비공개 상태로 유지하고, 최종적으로 공개 API 를 갖출 때 공개할 메서드만 골라서 노출하는 것.
			</div>

			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">array</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>

						<span style="color: #75715e">//비공개 프로퍼티</span>
					<span style="color: #66d9ef">var</span>	<span style="color: #a6e22e">array_string</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;[object Array]&quot;</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">ops</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Object.</span><span style="color: #a6e22e">prototype</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">toString</span><span style="color: #f8f8f2">,</span>

						<span style="color: #75715e">// 비공개 메서드들</span>
						<span style="color: #a6e22e">inArray</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(</span><span style="color: #a6e22e">neddle</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span> <span style="color: #66d9ef">var</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">max</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">max</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">){</span>
								<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">haystack</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">needle</span><span style="color: #f8f8f2">){</span>
									<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">i</span><span style="color: #f8f8f2">;</span>
								<span style="color: #f8f8f2">}</span>
							<span style="color: #f8f8f2">}</span>
							<span style="color: #66d9ef">return</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">},</span>
						<span style="color: #a6e22e">isArray</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">funciton</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">ops</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">call</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">a</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">===</span> <span style="color: #a6e22e">array_string</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">}</span>

					<span style="color: #75715e">// var 선언을 마친다. </span>

					<span style="color: #75715e">// 공개 API 노출</span>
					<span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">isArray</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">isArray</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">indexOf</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">inArray</span>
					<span style="color: #f8f8f2">}</span>
				<span style="color: #f8f8f2">}());</span>
				</pre>
			</div>

			<h3>생성자를 생성하는 모듈</h3>
			<div>
				생성자 함수를 사용해 객체를 만드는 게 더 편할 때도 있다<br>
				모듈 패턴을 사용하면서도 이렇게 할 수 있다. 모듈을 감싼 즉시 실행 함수가 마지막에 객체가 아니라 함수를 반환하게 하면된다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">namespace</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&#39;MYAPP.utilities.Array&#39;</span><span style="color: #f8f8f2">);</span>

				<span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.Array</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span> <span style="color: #f8f8f2">(){</span>
					<span style="color: #75715e">// 의존 관계 선언</span>
					<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">uobj</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">object</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">uleng</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">lang</span><span style="color: #f8f8f2">,</span>
						<span style="color: #75715e">// 비공개 프로퍼티와 메서드들을 선언한 후 </span>
						<span style="color: #a6e22e">Constr</span><span style="color: #f8f8f2">;</span>

						<span style="color: #75715e">// var 선언을 마친다.</span>

					<span style="color: #75715e">//필요하면 초기화 절차를 실행</span>
					<span style="color: #75715e">// ...</span>

					<span style="color: #75715e">// 공개 API - 생성자 함수</span>
					<span style="color: #a6e22e">Constr</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">o</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #66d9ef">this</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">element</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">this</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">toArray</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">o</span><span style="color: #f8f8f2">);</span>
					<span style="color: #f8f8f2">};</span>

					<span style="color: #75715e">// 공개 API - 프로토타입</span>
					<span style="color: #a6e22e">Constr</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">prototype</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span>
						<span style="color: #a6e22e">constructor</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.Array,</span>
						<span style="color: #a6e22e">version</span> <span style="color: #f92672">:</span> <span style="color: #e6db74">&quot;2.0&quot;</span><span style="color: #f8f8f2">,</span>
						<span style="color: #a6e22e">toArray</span> <span style="color: #f92672">:</span> <span style="color: #a6e22e">funciton</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
							<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">var</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">a</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[],</span> <span style="color: #a6e22e">len</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">length</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span><span style="color: #f92672">&lt;</span> <span style="color: #a6e22e">len</span><span style="color: #f8f8f2">;</span> <span style="color: #a6e22e">i</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">){</span>
								<span style="color: #a6e22e">a</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">[</span><span style="color: #a6e22e">i</span><span style="color: #f8f8f2">];</span>
							<span style="color: #f8f8f2">}</span>
							<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">a</span><span style="color: #f8f8f2">;</span>
						<span style="color: #f8f8f2">}</span>
					<span style="color: #f8f8f2">};</span>

					<span style="color: #75715e">// 생성자 함수를 반환한다.</span>
					<span style="color: #75715e">// 이 함수가 새로운 네임스페이스에 할다오딜 것이다. </span>
					<span style="color: #66d9ef">return</span> <span style="color: #a6e22e">Constr</span><span style="color: #f8f8f2">;</span>

				<span style="color: #f8f8f2">}());</span>
				</pre>
			</div>

			<div>
				이 생성자 함수는 다음과 같이 사용한다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%">
				<span style="color: #66d9ef">var</span> <span style="color: #a6e22e">arr</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.Array(</span><span style="color: #a6e22e">obj</span><span style="color: #f8f8f2">);</span>
				</pre>
			</div>

			<h3>모듈에 전역변수 가져오기 </h3>
			<div>
				모듈을 감싼 즉시 실행 함수에 인자를 전달하는 형태가 있다. 어떠한 값이라도 가능하지만, 보통 전역 변수에 대한 참조 또는 전역 객체 자체를 전달한다. 이렇게 전역 변수를 전달하면 즉시 실행 함수내에서 지역변수로 사용할 수 있게 되기 때문에 탐색작업이 좀 더 빨라진다.
			</div>
			<!-- HTML generated using hilite.me -->
			<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
				<pre style="margin: 0; line-height: 125%"><span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">utilities</span><span style="color: #f8f8f2">.</span><span style="color: #a6e22e">module</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">function</span><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">app</span><span style="color: #f8f8f2">,</span> <span style="color: #a6e22e">global</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
				<span style="color: #75715e">// 전역 객체에 대한 참조와</span>
				<span style="color: #75715e">// 전역 애플리케이션 네임스페이스 객체에 대한 참조가 지역 변수화 된다. </span>
				<span style="color: #f8f8f2">}(</span><span style="color: #a6e22e">MYAPP</span><span style="color: #f8f8f2">,</span> <span style="color: #66d9ef">this</span><span style="color: #f8f8f2">));</span>
				</pre>
			</div>
		</section>

		<h2 id="con5">5.5 샌드박스 패턴</h2>
		<section>
			<div>
				샌드박스패턴은 네임스페이스패턴의 다음과 같은 단점을 해결한다.<br><br>
				<ul>
					<li>
						네임스페이스패턴은 애플리케이션 전역객체가 닫 하나의 전역변수에 의존한다.<br>
						따라서 네임스페이스 패턴으로는 동일한 애플리케이션이나 라이브러리의 두 가지 버전을 한 페이지에서 실행시키는 것이 불가능하다. 여러버전들이 모두 MYAPP이라는 동일한 전역변수명을 쓰기 때문이다.
					</li>
					<li>
						MYAPP.utilities.array와 같이 점으로 연결된 긴 이름을 써야하고 런타임에는 탐색작업을 거쳐야 한다.
					</li>
				</ul>
				<br><br>
				샌드박스패턴은 어떤 모듈이 다른 모듈과 그 모듈의 샌드박스에 영향을 미치지않고 동작할 수 있는 환경을 제공한다.
			</div>

			<h3>전역 생성자</h3>
			<div>
				샌드박스 패턴의 유일한 전역은 생성자다. 이것을 Sandbox()라고 하자. <br>
				이 생성자를 통해 객체를 생성하여 콜백함수를 전달해 해당코드를 샌드박스 내부 환경으로 격려시킬 것이다. <br><br>
				샌드박스 사용법은 다음과 같다.
			</div>
			<div class="colorscripter-code" style="color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto">
				<table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#272727; border-radius:4px;" cellspacing="0" cellpadding="0">
					<tr><td style="padding:6px 0"><div style="margin:0; padding:0; color:#f0f0f0; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">new</span>&nbsp;Sandbox(<span style="color:#ff3399">function</span>&nbsp;(box)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">//&nbsp;여기에&nbsp;코드가&nbsp;들어간다.&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">});</div></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white"><span style="font-size:9px; word-break:normal; background-color:#4f4f4f; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr>
				</table>
			</div>

			<div>
				box 객체는 네임스페이스 패턴에서의 MYAPP 과 같은 것이다. 코드가 동작하는데 필요한 모든 라이브러리 기능들이 여기에 들어간다. <br>
				이 패턴에 두가지를 추가해보자. <br><br>
				<ul>
					<li>
						3장에서 나왔던 new를 강제하는 패턴을 활용하여 객체를 생성할 때 new를 쓰지 않아도 되게 만든다.
					</li>
					<li>
						Sandbox() 생성자가 선택적인 인자를 하나 이상 받을 수 있게한다. 이 인자들은 객체를 생성하는 데 필요한 모듈의 이름을 지정한다. 우리는 코드의 모듈화를 지향하고 있으므로 Sandbox() 가 제공하는 기능 대부분이 실제로는 모듈안에 담겨지게 될것이다.
					</li>
				</ul>
			</div>
		</section>
	</section>

	<a href="#" class="btn_top" id="btn_top">TOP</a>
	<footer>
		<address>Jewdri . 출처 : JavaScript Patterns</address>
	</footer>
</div>
</body>
</html>